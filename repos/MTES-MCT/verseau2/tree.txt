.
├── .agent
│   └── rules
│       └── commit-message.md
├── .claude
│   └── skills
│       ├── dsfr-component
│       │   └── SKILL.md
│       ├── fullstack-route
│       │   └── SKILL.md
│       ├── nestjs-testing
│       │   └── SKILL.md
│       └── test-front-component
│           └── SKILL.md
├── .cursor
│   └── rules
│       └── commit
│           └── RULE.md
├── .dockerignore
├── .github
│   ├── copilot-instructions.md
│   └── workflows
│       └── test.yml
├── .gitignore
├── .husky
│   └── pre-commit
├── .prettierrc
├── AGENTS.md
├── Procfile
├── README.md
├── apps
│   ├── back
│   │   ├── README.md
│   │   ├── arch-unit-ts.json
│   │   ├── eslint.config.mjs
│   │   ├── example.env
│   │   ├── nest-cli.json
│   │   ├── nodemon-server.json
│   │   ├── nodemon-worker.json
│   │   ├── package.json
│   │   ├── src
│   │   │   ├── api
│   │   │   │   ├── api.module.ts
│   │   │   │   ├── frontend
│   │   │   │   │   └── frontend-static.module.ts
│   │   │   │   ├── middleware
│   │   │   │   │   ├── correlationId.middleware.ts
│   │   │   │   │   └── loggerRequest.middleware.ts
│   │   │   │   └── version.controller.ts
│   │   │   ├── authentication
│   │   │   │   ├── authentication.controller.ts
│   │   │   │   ├── authentication.factory.ts
│   │   │   │   ├── authentication.middleware.ts
│   │   │   │   ├── authentication.mock.service.ts
│   │   │   │   ├── authentication.module.ts
│   │   │   │   ├── authentication.service.spec.ts
│   │   │   │   ├── authentication.service.ts
│   │   │   │   ├── authentication.ts
│   │   │   │   ├── hasUserAccessToDepot.guard.ts
│   │   │   │   ├── isAdmin.guard.spec.ts
│   │   │   │   ├── isAdmin.guard.ts
│   │   │   │   ├── me.guard.spec.ts
│   │   │   │   └── me.guard.ts
│   │   │   ├── dossier
│   │   │   │   ├── controle
│   │   │   │   │   ├── controle.controller.ts
│   │   │   │   │   ├── controle.entity.ts
│   │   │   │   │   ├── controle.gateway.ts
│   │   │   │   │   ├── controle.model.ts
│   │   │   │   │   ├── controle.repository.ts
│   │   │   │   │   ├── isov1
│   │   │   │   │   │   ├── controle.mapper.ts
│   │   │   │   │   │   └── controlev1.service.ts
│   │   │   │   │   ├── metierv2
│   │   │   │   │   │   ├── controleMetierV2.service.spec.ts
│   │   │   │   │   │   ├── controleMetierV2.service.ts
│   │   │   │   │   │   ├── filterFctAssainissementForMetierV2.spec.ts
│   │   │   │   │   │   └── filterFctAssainissementForMetierV2.ts
│   │   │   │   │   └── technique
│   │   │   │   │       └── sandre
│   │   │   │   │           ├── reponseSandre.entity.ts
│   │   │   │   │           ├── reponseSandre.gateway.ts
│   │   │   │   │           ├── reponseSandre.model.ts
│   │   │   │   │           ├── reponseSandre.repository.ts
│   │   │   │   │           ├── sandre.mapper.ts
│   │   │   │   │           ├── sandre.mock.service.ts
│   │   │   │   │           ├── sandre.service.spec.ts
│   │   │   │   │           ├── sandre.service.ts
│   │   │   │   │           └── sandre.ts
│   │   │   │   ├── depot
│   │   │   │   │   ├── depot.controller.ts
│   │   │   │   │   ├── depot.entity.spec.ts
│   │   │   │   │   ├── depot.entity.ts
│   │   │   │   │   ├── depot.gateway.ts
│   │   │   │   │   ├── depot.mapper.ts
│   │   │   │   │   ├── depot.model.ts
│   │   │   │   │   ├── depot.repository.ts
│   │   │   │   │   ├── depot.service.ts
│   │   │   │   │   ├── depotAdmin.controller.ts
│   │   │   │   │   ├── depotCoordinator.service.spec.ts
│   │   │   │   │   ├── depotCoordinator.service.ts
│   │   │   │   │   ├── depotError.ts
│   │   │   │   │   ├── droitsDepot.service.ts
│   │   │   │   │   ├── file
│   │   │   │   │   │   └── file.ts
│   │   │   │   │   └── usecase
│   │   │   │   │       └── deposerUnFichier.ts
│   │   │   │   ├── dossier.module.ts
│   │   │   │   ├── masa
│   │   │   │   │   ├── masa.controller.ts
│   │   │   │   │   ├── masa.entity.ts
│   │   │   │   │   ├── masa.gateway.ts
│   │   │   │   │   ├── masa.mapper.ts
│   │   │   │   │   ├── masa.model.ts
│   │   │   │   │   ├── masa.repository.ts
│   │   │   │   │   ├── masa.schema.ts
│   │   │   │   │   ├── masa.service.ts
│   │   │   │   │   ├── masaApiKey.guard.ts
│   │   │   │   │   └── masaIp.guard.ts
│   │   │   │   └── rapport
│   │   │   │       ├── generateDummyPdf.ts
│   │   │   │       └── rapportPdfGenerator.service.ts
│   │   │   ├── indicateurs
│   │   │   │   ├── indicateurs.controller.ts
│   │   │   │   ├── indicateurs.gateway.ts
│   │   │   │   ├── indicateurs.module.ts
│   │   │   │   ├── indicateurs.repository.ts
│   │   │   │   └── indicateurs.service.ts
│   │   │   ├── infra
│   │   │   │   ├── config
│   │   │   │   │   └── configuration.module.ts
│   │   │   │   ├── database
│   │   │   │   │   ├── database.module.ts
│   │   │   │   │   ├── migration.service.ts
│   │   │   │   │   ├── migrationDatasource.ts
│   │   │   │   │   └── typeorm-logger.ts
│   │   │   │   ├── infra.module.ts
│   │   │   │   ├── queue
│   │   │   │   │   ├── pgboss.ts
│   │   │   │   │   ├── queue.module.ts
│   │   │   │   │   ├── queue.provider.ts
│   │   │   │   │   ├── queue.service.ts
│   │   │   │   │   └── queue.ts
│   │   │   │   ├── s3
│   │   │   │   │   ├── s3.factory.ts
│   │   │   │   │   ├── s3.module.ts
│   │   │   │   │   ├── s3.provider.mock.ts
│   │   │   │   │   ├── s3.service.ts
│   │   │   │   │   └── s3.ts
│   │   │   │   ├── sftp
│   │   │   │   │   ├── sftp.factory.ts
│   │   │   │   │   ├── sftp.module.ts
│   │   │   │   │   ├── sftp.provider.mock.ts
│   │   │   │   │   ├── sftp.service.ts
│   │   │   │   │   ├── sftp.spec.ts
│   │   │   │   │   ├── sftp.ts
│   │   │   │   │   ├── sftpAgency.factory.ts
│   │   │   │   │   ├── sftpAgency.mock.ts
│   │   │   │   │   ├── sftpAgency.service.ts
│   │   │   │   │   ├── sftpAgency.spec.ts
│   │   │   │   │   └── sftpAgency.ts
│   │   │   │   └── throttler
│   │   │   │       └── throttler.module.ts
│   │   │   ├── main.ts
│   │   │   ├── mainServer.ts
│   │   │   ├── mainWorker.ts
│   │   │   ├── masa
│   │   │   │   ├── controleMetier.dto.ts
│   │   │   │   ├── masa.module.ts
│   │   │   │   └── masa.provider.ts
│   │   │   ├── notification
│   │   │   │   ├── brevo
│   │   │   │   │   ├── email.factory.ts
│   │   │   │   │   ├── emailBrevo.provider.ts
│   │   │   │   │   ├── emailBrevoCatcher.provider.ts
│   │   │   │   │   └── emailBrevoMock.provider.ts
│   │   │   │   ├── email.provider.ts
│   │   │   │   ├── notification.gateway.ts
│   │   │   │   ├── notification.module.ts
│   │   │   │   ├── notification.producer.ts
│   │   │   │   └── notification.ts
│   │   │   ├── referentiel
│   │   │   │   ├── lanceleau
│   │   │   │   │   ├── entities
│   │   │   │   │   │   ├── ag.entity.ts
│   │   │   │   │   │   ├── cdb.entity.ts
│   │   │   │   │   │   ├── fan.entity.ts
│   │   │   │   │   │   ├── itv.entity.ts
│   │   │   │   │   │   ├── orionCredentials.entity.ts
│   │   │   │   │   │   ├── orionRoleForPrincipal.entity.ts
│   │   │   │   │   │   ├── par.entity.ts
│   │   │   │   │   │   ├── reg.entity.ts
│   │   │   │   │   │   ├── sup.entity.ts
│   │   │   │   │   │   ├── urf.entity.ts
│   │   │   │   │   │   └── vSteuSclItv.entity.ts
│   │   │   │   │   ├── lanceleau.gateway.ts
│   │   │   │   │   ├── lanceleau.model.ts
│   │   │   │   │   └── lanceleau.repository.ts
│   │   │   │   ├── parametre
│   │   │   │   │   ├── codeParametre.ts
│   │   │   │   │   └── parametre.gateway.ts
│   │   │   │   ├── referentiel.controller.ts
│   │   │   │   ├── referentiel.gateway.ts
│   │   │   │   ├── referentiel.module.ts
│   │   │   │   ├── referentiel.repository.ts
│   │   │   │   └── roseau
│   │   │   │       ├── entities
│   │   │   │       │   ├── aga.entity.ts
│   │   │   │       │   ├── agac.entity.ts
│   │   │   │       │   ├── agat.entity.ts
│   │   │   │       │   ├── cpy.entity.ts
│   │   │   │       │   ├── cxnadm.entity.ts
│   │   │   │       │   ├── cxntech.entity.ts
│   │   │   │       │   ├── pmo.entity.ts
│   │   │   │       │   ├── resa.entity.ts
│   │   │   │       │   ├── scl.entity.ts
│   │   │   │       │   ├── stchan.entity.ts
│   │   │   │       │   ├── steu.entity.ts
│   │   │   │       │   ├── tlref.entity.ts
│   │   │   │       │   └── tltobl.entity.ts
│   │   │   │       ├── roseau.gateway.ts
│   │   │   │       └── roseau.repository.ts
│   │   │   ├── shared
│   │   │   │   ├── cerbereIdCache.interceptor.ts
│   │   │   │   ├── constants
│   │   │   │   │   ├── customRequest.ts
│   │   │   │   │   └── mimeTypes.ts
│   │   │   │   ├── fileControl.ts
│   │   │   │   ├── guards
│   │   │   │   │   ├── useOrGuards.spec.ts
│   │   │   │   │   └── useOrGuards.ts
│   │   │   │   ├── logger
│   │   │   │   │   ├── cls-store.interface.ts
│   │   │   │   │   ├── logConfig.ts
│   │   │   │   │   ├── logger.mock.ts
│   │   │   │   │   ├── logger.service.spec.ts
│   │   │   │   │   ├── logger.service.ts
│   │   │   │   │   ├── traceCalls.decorator.spec.ts
│   │   │   │   │   └── traceCalls.decorator.ts
│   │   │   │   ├── memory-monitor
│   │   │   │   │   └── memoryMonitor.service.ts
│   │   │   │   ├── repository
│   │   │   │   │   └── base-entity.ts
│   │   │   │   ├── schema
│   │   │   │   │   ├── filename.schema.spec.ts
│   │   │   │   │   ├── filename.schema.ts
│   │   │   │   │   ├── filename.service.ts
│   │   │   │   │   ├── index.ts
│   │   │   │   │   └── zodValidation.pipe.ts
│   │   │   │   ├── service
│   │   │   │   │   └── string.service.ts
│   │   │   │   ├── shared.module.ts
│   │   │   │   └── useCase.ts
│   │   │   ├── user
│   │   │   │   ├── droitsUser.service.spec.ts
│   │   │   │   ├── droitsUser.service.ts
│   │   │   │   ├── user.entity.ts
│   │   │   │   ├── user.gateway.ts
│   │   │   │   ├── user.model.ts
│   │   │   │   ├── user.module.ts
│   │   │   │   ├── user.repository.ts
│   │   │   │   └── user.service.ts
│   │   │   └── worker
│   │   │       ├── asyncTask.ts
│   │   │       ├── controleMetier
│   │   │       │   ├── controleMetierProcessor.service.spec.ts
│   │   │       │   └── controleMetierProcessor.service.ts
│   │   │       ├── controleSandre
│   │   │       │   ├── controle-sandre-poll.processor.service.ts
│   │   │       │   └── controle-sandre-upload.processor.service.ts
│   │   │       ├── fileProcessor
│   │   │       │   └── fileProcessor.service.ts
│   │   │       ├── masa
│   │   │       │   └── masaWebhookProcessor.service.ts
│   │   │       ├── sftp
│   │   │       │   ├── sftpAgentVerseauProcessor.service.spec.ts
│   │   │       │   └── sftpAgentVerseauProcessor.service.ts
│   │   │       ├── worker.module.ts
│   │   │       └── worker.service.ts
│   │   ├── test
│   │   │   ├── architecture
│   │   │   │   ├── Architecture.spec.ts
│   │   │   │   ├── ControllerGuardParser.ts
│   │   │   │   ├── MatchingPattern.ts
│   │   │   │   └── TypeScriptSourceHelper.ts
│   │   │   ├── controle.helper.ts
│   │   │   ├── controller.e2e-spec.ts
│   │   │   ├── createReferentielDataset.ts
│   │   │   ├── depot.helper.ts
│   │   │   ├── dossier
│   │   │   │   ├── controle
│   │   │   │   │   ├── isov1
│   │   │   │   │   │   └── controlev1.e2e-spec.ts
│   │   │   │   │   ├── reponseSandre.e2e-spec.ts
│   │   │   │   │   └── v2
│   │   │   │   │       └── controleMetierV2.e2e-spec.ts
│   │   │   │   ├── depot
│   │   │   │   │   ├── depot-step-history.e2e-spec.ts
│   │   │   │   │   ├── depot-upload.e2e-spec.ts
│   │   │   │   │   └── droitsDepot.e2e-spec.ts
│   │   │   │   ├── dossier.e2e-spec-api-worker.ts
│   │   │   │   └── dossier.e2e-spec.ts
│   │   │   ├── fixtures
│   │   │   │   └── fctAssainissement.fixture.ts
│   │   │   ├── global-setup.ts
│   │   │   ├── global-teardown.ts
│   │   │   ├── indicateurs
│   │   │   │   └── indicateurs.e2e-spec.ts
│   │   │   ├── init
│   │   │   │   └── initTestContainer.ts
│   │   │   ├── jest-e2e-api-worker.json
│   │   │   ├── jest-e2e.json
│   │   │   ├── mock
│   │   │   │   ├── databaseMock.module.ts
│   │   │   │   ├── infraMock.module.ts
│   │   │   │   ├── infraWithRealDbMock.module.ts
│   │   │   │   ├── pg-boss.mock.ts
│   │   │   │   ├── queueMock.module.ts
│   │   │   │   ├── queueTestHelper.ts
│   │   │   │   ├── s3Mock.module.ts
│   │   │   │   └── shared-mocks.ts
│   │   │   ├── responseSandre.helper.ts
│   │   │   ├── shared
│   │   │   │   └── logger.service.e2e-spec.ts
│   │   │   ├── test.envfile
│   │   │   ├── testcontainer.config.ts
│   │   │   ├── userWithDroitsDataset.helper.ts
│   │   │   └── worker.e2e-spec.ts
│   │   ├── tsconfig.build.json
│   │   └── tsconfig.json
│   └── front
│       ├── README.md
│       ├── eslint.config.js
│       ├── favicon
│       │   └── favicon.svg
│       ├── icons
│       │   ├── fr-icon-loader-5-line.css
│       │   └── loader-5-line.svg
│       ├── index.html
│       ├── package.json
│       ├── public
│       │   ├── image_accueil.webp
│       │   └── vite.svg
│       ├── src
│       │   ├── App.css
│       │   ├── App.tsx
│       │   ├── api
│       │   │   ├── apiClient.ts
│       │   │   ├── depot.ts
│       │   │   ├── indicateurs.ts
│       │   │   └── referentiel.ts
│       │   ├── assets
│       │   │   └── react.svg
│       │   ├── components
│       │   │   ├── Breadcrumb.tsx
│       │   │   ├── ClickableStatCard.tsx
│       │   │   ├── ControleGroup.css
│       │   │   ├── ControleGroup.spec.tsx
│       │   │   ├── ControleGroup.tsx
│       │   │   ├── ControleGroupSandre.tsx
│       │   │   ├── ControleMessageCell.spec.tsx
│       │   │   ├── ControleMessageCell.tsx
│       │   │   ├── ControleResultBadges.tsx
│       │   │   ├── FileDropZone.css
│       │   │   ├── FileDropZone.tsx
│       │   │   ├── Footer.tsx
│       │   │   ├── Header.tsx
│       │   │   ├── IndicateursTable.css
│       │   │   ├── IndicateursTable.tsx
│       │   │   ├── MasaIntegrationStatus.tsx
│       │   │   ├── ProtectedRoute.tsx
│       │   │   └── StatCard.tsx
│       │   ├── contexts
│       │   │   └── AuthContext.tsx
│       │   ├── example.env
│       │   ├── helper
│       │   │   └── controleIconHelper.ts
│       │   ├── hooks
│       │   │   ├── useAuth.ts
│       │   │   ├── useControleStatistics.ts
│       │   │   ├── useControleTableData.ts
│       │   │   ├── useControleTableData.tsx
│       │   │   ├── useDepots.ts
│       │   │   ├── useGroupedControles.ts
│       │   │   ├── useIndicateursSteu.ts
│       │   │   ├── usePagination.ts
│       │   │   └── useRapportAndXmlDownload.ts
│       │   ├── index.css
│       │   ├── main.tsx
│       │   ├── pages
│       │   │   ├── CallbackPage.tsx
│       │   │   ├── Controle.tsx
│       │   │   ├── Dashboard.tsx
│       │   │   ├── DepotDetails.tsx
│       │   │   ├── DepotDownload.tsx
│       │   │   ├── DepotUpload.tsx
│       │   │   ├── DepotUploadRecap.tsx
│       │   │   ├── HomePage.tsx
│       │   │   ├── MockAuthorizationPage.tsx
│       │   │   ├── controleMapper.ts
│       │   │   └── depot-upload-recap
│       │   │       ├── components
│       │   │       │   ├── ChecksList.tsx
│       │   │       │   ├── EmptyState.tsx
│       │   │       │   ├── ErrorState.tsx
│       │   │       │   ├── FooterActions.tsx
│       │   │       │   ├── ParamsTags.tsx
│       │   │       │   ├── ParsingLoader.tsx
│       │   │       │   ├── RecapCard.css
│       │   │       │   ├── RecapCard.tsx
│       │   │       │   ├── RecapHeader.tsx
│       │   │       │   ├── RecapSummaryCard.tsx
│       │   │       │   └── index.ts
│       │   │       └── useDepotRecap.ts
│       │   ├── routes.ts
│       │   ├── services
│       │   │   ├── auth.service.ts
│       │   │   └── depot.service.ts
│       │   ├── temp
│       │   │   └── fakeAuth.ts
│       │   └── types
│       │       ├── auth.types.ts
│       │       └── controle.types.ts
│       ├── tsconfig.app.json
│       ├── tsconfig.json
│       ├── tsconfig.node.json
│       ├── vite.config.ts
│       └── vitest.setup.ts
├── devops
│   ├── local
│   │   ├── .dockerignore
│   │   ├── Dockerfile
│   │   ├── docker-compose.yml
│   │   └── start.sh
│   └── tools
│       └── sync-pg
│           ├── Dockerfile
│           ├── blue-green-manager.js
│           ├── config.js
│           ├── cron.json
│           ├── example.env
│           ├── index.js
│           ├── package-lock.json
│           ├── package.json
│           ├── pg-service.js
│           ├── s3-service.js
│           └── server.js
├── package-lock.json
├── package.json
├── packages
│   ├── dossier
│   │   ├── jest.config.js
│   │   ├── package.json
│   │   ├── src
│   │   │   ├── baseEntity.ts
│   │   │   ├── controle
│   │   │   │   ├── controle.dto.ts
│   │   │   │   ├── controleResult.ts
│   │   │   │   ├── evenement.ts
│   │   │   │   ├── messages.spec.ts
│   │   │   │   └── messages.ts
│   │   │   ├── depot
│   │   │   │   ├── depot.dto.ts
│   │   │   │   └── depot.status.ts
│   │   │   ├── index.ts
│   │   │   ├── indicateur
│   │   │   │   └── indicateur.dto.ts
│   │   │   ├── masa
│   │   │   │   └── masa.dto.ts
│   │   │   └── routes
│   │   │       ├── controle.routes.ts
│   │   │       ├── depot.routes.ts
│   │   │       ├── depotAdmin.routes.ts
│   │   │       ├── indicateurs.routes.ts
│   │   │       ├── referentiel.routes.ts
│   │   │       ├── route.types.spec.ts
│   │   │       └── route.types.ts
│   │   └── tsconfig.json
│   ├── parser
│   │   ├── jest.config.js
│   │   ├── package.json
│   │   ├── src
│   │   │   ├── index.ts
│   │   │   ├── sandreConstants.ts
│   │   │   ├── scenarioAssainissement.parser.spec.ts
│   │   │   ├── scenarioAssainissement.parser.ts
│   │   │   ├── scenarioAssainissement.ts
│   │   │   └── xml
│   │   │       ├── 18.6_MO_anonymized.xml
│   │   │       ├── compliant.ts
│   │   │       ├── compliantWithNomContact.ts
│   │   │       └── nonCompliantBadStructure.ts
│   │   └── tsconfig.json
│   └── shared
│       ├── jest.config.js
│       ├── package.json
│       ├── src
│       │   ├── date.service.ts
│       │   └── index.ts
│       └── tsconfig.json
└── test_charge.sh
111 directories, 390 files
